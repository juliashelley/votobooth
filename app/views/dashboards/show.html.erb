<div class="page-container">

  <div class="build-election-btn">
    <div class="btn-large-green-new">
      <%= link_to 'Build an election', new_election_path %>
    </div>
  </div>

  <hr>

  <div class="tabs nav nav-tabs">
    <a class="tab active" data-toggle="tab" href="#hosting">Hosting</a>
    <a class="tab"  data-toggle="tab" href="#running">Running</a>
    <a class="tab" data-toggle="tab" href="#voting">Voting</a>
  </div>


  <div class="tab-content">
    <div id="hosting" class="tab-pane show active">
      <div class="dashboard-card-container">
        <% @elections.each do |election| %>
        <div class="election">
          <div class="election-card-header">
           <h2 class="heading-regular-gray-thin"><%= election.name %></h2>
           <p class="<%=election.status%>">
            <%= election.election_status%>
          </p>
        </div>
        <div class="election-card-body">
          <div class="election-card-body-polling">
           <p>Polling period</p>
           <p id="election-date">
             <%= election.voting_start_date.strftime("%a %e %b %Y, %H:%M") %> - <%= election.voting_end_date.strftime("%a %e %b %Y, %H:%M") %></p>
           <p>For <%=election.eligible_voters.count%> voters</p>
         </div>
        <%= link_to election_approval_path(election) do %>
          <div class="election-card-body-candidates">
            <div class="number-badge">
              <h4><%= election.pending_candidates.count %></h4>
            </div>
            <p> <%= "candidate".pluralize(election.pending_candidates.count)%> to review</p>
          </div>
        <% end %>

        <div class="election-card-status">
          <div class="election-card-status-section">
            <h4 class="heading-regular-gray-thin"><%= election.total_votes %></h4>
            <p>
              <%= "vote".pluralize(election.total_votes)%>
            </p>
          </div>
          <div class="election-card-status-section">
            <h4 class="heading-regular-gray-thin">
              <%= election.approved_candidates.count%>
            </h4>
            <%= link_to election_candidatures_path(election) do %>
              <p>candidates</p>
            <% end %>
          </div>
          <div class="election-card-status-section">
            <h6><%= election.set_time_remaining[0] %> hours, <%= election.set_time_remaining[1] %> mins</h6>
            <p id="time-remaining">Time remaining</p>
          </div>
        </div>
        <div class="btn-small-white">
          <%= link_to 'View details', election_path(election.id)%>
        </div>
      </div>
    </div>
    <% end %>
  </div>
</div>

<div id="running" class="tab-pane fade election">
  <% @candidatures.each do |candidature| %>
  <div class="card-grid col-xs-12 col-lg-6">
    <div class="election-card-header">
     <h2 class="heading-regular-gray-thin"><%= candidature.election.name %></h2>
   </div>
   <div class="election-card-body-polling">
    <p>Election Date</p>
    <p><strong><%= candidature.election.voting_start_date %> - <%= candidature.election.voting_end_date %></strong></p>
  </div>
  <div class="btn-group">
    <button type="button" class="btn btn-large-white dropdown-toggle" data-toggle="dropdown">
      Options <span class="caret"></span>
    </button>

    <ul class="dropdown-menu" role="menu">
      <li class="dropdown-btn ">
        <div class="element"><%= link_to "Edit candidature", edit_candidature_path(candidature.id), {:remote => true, 'data-toggle' =>  "modal", 'data-target' => '#modal-window'} %> </div> </li>
      <li class="dropdown-btn">
        <div class="element"><%= link_to "Withdraw from race", candidature_path(candidature.id), method: :delete, data: { confirm: "Do you want to remove #{candidature.name}?" }, html: {:remote => true, 'data-toggle' =>  "modal", 'data-target' => '#modal-window'} %></div> </li>
    </ul>
  </div>


  <hr>
</div>
<% end %>
</div>

<div id="voting" class="tab-pane fade election">
  <% @voter.each do |voter| %>
    <div class="vote-in-election">
      <h2><%= voter.election.name %></h2>
      <%= link_to 'See candidates', election_candidatures_path(voter.election), class: "btn-small-white"%>
    </div>
    <hr>
  <% end %>
</div>
</div>
</div>
